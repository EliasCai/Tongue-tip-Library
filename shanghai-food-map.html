<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>民国上海美食地图</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body, #map { height: 100%; margin: 0; padding: 0; }
    .amap-info-content { font-size: 14px; }
    .legend {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(255,255,255,0.9);
      border-radius: 6px;
      padding: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      z-index: 1000;
    }
    .legend-item { display: flex; align-items: center; margin-bottom: 6px; }
    .legend-icon { width: 20px; height: 20px; margin-right: 6px; }
    .marker-label {
      font-size: 14px;
      color: #fff;
      background: rgba(139,69,19,0.85);
      border-radius: 4px;
      padding: 2px 6px;
      white-space: nowrap;
      transition: background 0.2s;
      border: none;
    }
    .marker-label-hover {
      background: rgba(139,69,19,0.95);
      color: #ffd700;
    }
    .amap-marker-label {
      border: none !important;
      box-shadow: none !important;
      background: none !important;
      padding: 0 !important;
    }
  </style>
  <script src="https://webapi.amap.com/maps?v=2.0&key=278641d30cc5bc2acfc080fe5d9ad884"></script>
</head>
<body>
  <div id="map"></div>
  <div class="legend" id="legend"></div>
  
  <script>
    // 民国上海餐馆数据
    const restaurantData = [
      {"type":"北京菜","name":"同兴楼","address":"福州路435号","location":"121.481986,31.233629"},
      {"type":"北京菜","name":"悦宾楼","address":"湖北路215号","location":"121.480302,31.233912"},
      {"type":"北京菜","name":"会宾楼","address":"福州路419号","location":"121.482369,31.234044"},
      {"type":"北京菜","name":"致美楼","address":"福州路519号","location":"121.480605,31.233343"},
      {"type":"天津菜","name":"六合局","address":"广西路福祥里隔壁","location":"121.477614,31.233638"},
      {"type":"天津菜","name":"三和楼","address":"云南南路13号","location":"121.479738,31.228803"},
      {"type":"天津菜","name":"青萍园","address":"云南南路305号","location":"121.48256,31.225227"},
      {"type":"四川菜","name":"成都川菜馆","address":"宁海西路22号","location":"121.472966,31.224718"},
      {"type":"四川菜","name":"南海花园","address":"南京西路830号","location":"121.467247,31.231172"},
      {"type":"四川菜","name":"蜀腴川菜馆","address":"广西北路295号","location":"121.477167,31.234549"},
      {"type":"四川菜","name":"聚丰园川菜馆","address":"广西北路234号","location":"121.477722,31.233137"},
      {"type":"四川菜","name":"洁而精川菜馆","address":"兴安路135号","location":"121.471016,31.220962"},
      {"type":"四川菜","name":"锦江川菜馆","address":"宁海西路31号","location":"121.472966,31.224718"},
      {"type":"广东菜","name":"一家春","address":"福州路266号","location":"121.485223,31.234628"},
      {"type":"广东菜","name":"大三元","address":"南京路677号","location":"121.470773,31.232453"},
      {"type":"广东菜","name":"大东酒楼","address":"南京路625号","location":"121.470708,31.232439"},
      {"type":"广东菜","name":"杏花楼","address":"福州路343号","location":"121.484144,31.234114"},
      {"type":"广东菜","name":"金门大酒店","address":"南京西路104号","location":"121.472522,31.234147"},
      {"type":"广东菜","name":"京华酒楼","address":"福州路623号","location":"121.478925,31.232289"},
      {"type":"广东菜","name":"东亚又一楼","address":"南京东路先施公司","location":"121.477072,31.234663"},
      {"type":"广东菜","name":"南国酒楼","address":"云南路366号","location":"121.482646,31.224314"},
      {"type":"广东菜","name":"南华酒楼","address":"南京东路715号","location":"121.477072,31.234663"},
      {"type":"广东菜","name":"美心酒楼","address":"陕西南路304号","location":"121.461798,31.207557"},
      {"type":"广东菜","name":"美华酒楼","address":"南京西路吴江路15号","location":"121.463883,31.230694"},
      {"type":"广东菜","name":"万寿山","address":"西藏中路220号","location":"121.475371,31.232186"},
      {"type":"广东菜","name":"新新酒楼","address":"南京东路720号","location":"121.477072,31.234663"},
      {"type":"广东菜","name":"新雅酒楼","address":"南京东路719号","location":"121.477072,31.234663"},
      {"type":"广东菜","name":"醉乐园","address":"金陵东路376号","location":"121.482316,31.228086"},
      {"type":"广东菜","name":"乐园酒楼","address":"凤阳路366号","location":"121.469042,31.233327"},
      {"type":"徽州菜","name":"大中国菜馆","address":"大连路469号","location":"121.513564,31.258713"},
      {"type":"徽州菜","name":"大有利菜馆","address":"安福路39号","location":"121.44732,31.214834"},
      {"type":"徽州菜","name":"大富贵菜馆","address":"常德路706号","location":"121.44388,31.232218"},
      {"type":"徽州菜","name":"大新楼菜馆","address":"西藏中路485号","location":"121.474491,31.235636"},
      {"type":"徽州菜","name":"海华楼","address":"浙江北路270号","location":"121.47524,31.246245"},
      {"type":"宁波菜","name":"又二屯","address":"南京西路304号","location":"121.47031,31.232358"},
      {"type":"宁波菜","name":"大陆正興馆","address":"西藏中路67号","location":"121.478013,31.22964"},
      {"type":"宁波菜","name":"茹长兴","address":"长沙路93号","location":"121.470626,31.236079"},
      {"type":"宁波菜","name":"老同华楼","address":"九江路364号","location":"121.483129,31.235948"},
  {"type":"宁波菜","name":"状元楼","address":"天津路441号","location":"121.478825,31.236413"},
  {"type":"宁波菜","name":"甬江状元楼","address":"九江路529号","location":"121.480068,31.235024"},
  {"type":"宁波菜","name":"集贤楼","address":"广东路374号","location":"121.484251,31.232643"},
  {"type":"宁波菜","name":"复兴园","address":"广东路374号","location":"121.484251,31.232643"},
  {"type":"宁波菜","name":"宁波沁社","address":"西藏中路142号","location":"121.477716,31.230761"},
  {"type":"上海菜","name":"大名春楼菜馆","address":"浙江中路394号","location":"121.478014,31.236127"},
  {"type":"上海菜","name":"上海老正兴","address":"九江路566号","location":"121.479381,31.234817"},
  {"type":"上海菜","name":"正和馆","address":"安庆路481号","location":"121.475796,31.247401"},
  {"type":"上海菜","name":"正兴菜馆","address":"河南中路565号","location":"121.483932,31.239984"},
  {"type":"上海菜","name":"同华楼","address":"九江路281号","location":"121.484677,31.236393"},
  {"type":"上海菜","name":"状元老正兴","address":"福州路680号","location":"121.478345,31.231843"},
  {"type":"上海菜","name":"老正和菜馆","address":"广西北路207号","location":"121.477938,31.233011"},
  {"type":"上海菜","name":"老正兴源记","address":"九江路300号","location":"121.484316,31.236306"},
  {"type":"上海菜","name":"老正兴东记","address":"山东中路330号","location":"121.48409,31.236632"},
  {"type":"上海菜","name":"老正兴馆","address":"福州路721号","location":"121.477335,31.231846"},
  {"type":"上海菜","name":"梁园老正兴","address":"广西北路332号","location":"121.477042,31.235018"},
  {"type":"素菜","name":"功德林斋食处","address":"黄河路41号","location":"121.470911,31.233874"},
{"type":"素菜","name":"春风松月楼","address":"湖北路193号","location":"121.480558,31.233647"},
{"type":"素菜","name":"素春楼","address":"厦门路102号","location":"121.476476,31.239673"},
{"type":"素菜","name":"聚源斋","address":"湖北路90号","location":"121.481441,31.232135"},
{"type":"素菜","name":"龙兴斋","address":"芝罘路159号","location":"121.474438,31.237671"},
{"type":"素菜","name":"觉林","address":"林森中路254号","location":"121.016158,30.888288"},
{"type":"西菜","name":"华懋饭店","address":"南京路外滩沙逊房子内","location":"121.483723,31.238521"},
{"type":"西菜","name":"都城饭店","address":"江西路福州路角","location":"121.482468,31.233819"},
{"type":"西菜","name":"沧州饭店","address":"南京西路1225号","location":"121.454122,31.226639"},
{"type":"西菜","name":"汇中饭店","address":"南京东路3号","location":"121.477072,31.234663"},
{"type":"西菜","name":"礼查饭店","address":"中正东一路7号","location":"121.287296,31.114386"},
{"type":"西菜","name":"麦瑞饭店","address":"南京东路102号","location":"121.477072,31.234663"},
{"type":"西菜","name":"国际饭店","address":"南京西路跑马厅旁","location":"121.455774,31.227623"},
{"type":"西菜","name":"沙利文饭店","address":"南京东路107号","location":"121.477072,31.234663"},
{"type":"中国西菜","name":"水上饭店","address":"中山东一路北京东路口","location":"121.490243,31.240637"},
{"type":"中国西菜","name":"一品香大旅社","address":"西藏中路270号","location":"121.474916,31.233072"},
{"type":"中国西菜","name":"一家春番菜社","address":"福州路266号","location":"121.485223,31.234628"},
{"type":"中国西菜","name":"上海西菜社","address":"广东路150号","location":"121.488322,31.233513"},
{"type":"中国西菜","name":"大西洋西菜社","address":"福州路701号","location":"121.477544,31.231892"},
{"type":"中国西菜","name":"大西洋饭店","address":"北京西路1182号","location":"121.452719,31.229429"},
{"type":"中国西菜","name":"大来饭店","address":"南京西路1257号","location":"121.455759,31.227014"},
{"type":"中国西菜","name":"中央西菜社","address":"福州路730号","location":"121.477097,31.23214"},
{"type":"中国西菜","name":"印度吖喱饭店","address":"福州路711号","location":"121.477444,31.231872"},
{"type":"中国西菜","name":"东亚酒楼","address":"南京东路690号","location":"121.477072,31.234663"},
{"type":"中国西菜","name":"晋隆西菜社","address":"西藏中路400号","location":"121.474982,31.235651"},
{"type":"中国西菜","name":"新利查番菜社","address":"广西北路164号","location":"121.479489,31.232254"},
{"type":"中国西菜","name":"荣康中西菜社","address":"华山路1号","location":"121.444849,31.223637"},
{"type":"中国西菜","name":"福来犹太咖喱鸡饭店","address":"广西北路159号","location":"121.479675,31.232196"},
    ];

    // 菜系到图标的映射
    const cuisineIcons = {
      '北京菜': 'https://ai-studio-static-online.cdn.bcebos.com/e226f0a3dd604ecf89b47ec3311d01ce8072b4084aaa4ab5872ede1726def944',
      '天津菜': 'https://ai-studio-static-online.cdn.bcebos.com/e21c4f50170b42f78d18294cb5825c4123f0898c91b14ea4af22f78e42e732f0',
      '四川菜': 'https://ai-studio-static-online.cdn.bcebos.com/20082100695540b59ef948ea1e1230ff6750e05d5dfd471e877742f242fd8419',
      '广东菜': 'https://ai-studio-static-online.cdn.bcebos.com/eace9ecb10014aae8403105c539f651c485f80f371b64dfdba5fbe9100ddcfac',
      '徽州菜': 'https://ai-studio-static-online.cdn.bcebos.com/35c104af833f45fbbe11b53d1126443b5137a3c5c4594605a24510c4138789d3',
      '宁波菜': 'https://ai-studio-static-online.cdn.bcebos.com/1f4e4642282f4c79a3ab7a7a3562048291d1a448e52943f982e05551a441621c',
      '上海菜': 'https://ai-studio-static-online.cdn.bcebos.com/e8f7ecd86f284fb5b82e88910d0dbe631b74dc50b9fb46b0b7029481eac74d5c',
      '西菜': 'https://ai-studio-static-online.cdn.bcebos.com/4236f8bd291c4f2bb66348b3e310efdf53ba239db5054bf6bb1eea520354b358',
      '素菜': 'https://ai-studio-static-online.cdn.bcebos.com/ebb4e758d42c4a45947db093e8232519b2fe101fbfdc490ab6a57f252e6b7e65',
      '中国西菜': 'https://ai-studio-static-online.cdn.bcebos.com/93f35084f140491690936f0ae6b087818c4658b056ee42abbe083a7b5d6c803c'
    };

    // 图例配置
    const legendTypes = [
      {type: '北京菜', label: '北京菜'},
      {type: '天津菜', label: '天津菜'},
      {type: '四川菜', label: '四川菜'},
      {type: '广东菜', label: '广东菜'},
      {type: '徽州菜', label: '徽州菜'},
      {type: '宁波菜', label: '宁波菜'},
      {type: '上海菜', label: '上海菜'},
      {type: '西菜', label: '西菜'},
      {type: '素菜', label: '素菜'},
      {type: '中国西菜', label: '中国西菜'}
    ];

    // 初始化地图 - 上海中心坐标
    const map = new AMap.Map('map', {
      center: [121.473701, 31.230416],
      zoom: 13
    });

    // 渲染图例
    const legend = document.getElementById('legend');
    legend.innerHTML = legendTypes.map(t =>
      `<div class="legend-item">
        <img class="legend-icon" src="${cuisineIcons[t.type]}" alt="${t.label}" />
        ${t.label}
      </div>`
    ).join('');

    // 信息窗口
    let infoWindow = null;

    // 渲染所有餐馆标记
    function renderRestaurants() {
      restaurantData.forEach(restaurant => {
        if (!restaurant.location) return;
        
        const [lng, lat] = restaurant.location.split(',').map(Number);
        const iconUrl = cuisineIcons[restaurant.type] || cuisineIcons['上海菜'];
        
        const marker = new AMap.Marker({
          position: [lng, lat],
          icon: new AMap.Icon({
            image: iconUrl,
            size: new AMap.Size(32, 32),
            imageSize: new AMap.Size(32, 32)
          }),
          title: restaurant.name,
          offset: new AMap.Pixel(-16, -32)
        });

        // 点击显示详情
        marker.on('click', () => showRestaurantInfo(restaurant));
        marker.setMap(map);
      });
    }

    // 显示餐馆信息
    function showRestaurantInfo(restaurant) {
      if (infoWindow) {
        infoWindow.close();
      }

      const content = `
        <div style="min-width:200px;max-width:280px;font-family:'Microsoft YaHei',sans-serif;">
          <div style="font-size:16px;font-weight:bold;margin-bottom:8px;color:#8B4513;">${restaurant.name}</div>
          <div style="margin-bottom:4px;"><strong>地址：</strong>${restaurant.address}</div>
          <div style="margin-bottom:4px;"><strong>菜系：</strong>${restaurant.type}</div>
        </div>
      `;

      const [lng, lat] = restaurant.location.split(',').map(Number);
      infoWindow = new AMap.InfoWindow({
        content,
        offset: new AMap.Pixel(0, -30)
      });
      infoWindow.open(map, [lng, lat]);
    }

    // 点击地图空白处关闭信息窗口
    map.on('click', function() {
      if (infoWindow) infoWindow.close();
    });

    // 初始化渲染
    renderRestaurants();
  </script>
</body>
</html>